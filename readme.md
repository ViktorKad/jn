## Шаблонизатор для web-приложений.

### Имя шаблона
В имени шаблона допускается использование латинских букв, цифр и знаков минус и подчеркивания.

### Общий синтаксис текстового шаблона
Текстовый шаблон - это просто строка с заменяемыми блоками.
Блоки начинаются с '[% ' и заканчиваются ' %]'.
В простейшем случае через '[% ... %]' можно вызвать другой шаблон, заменив этот блок его содержимым. Для этого достаточно написать [% имя_шиблона %]. Будет подставлен ближайший найденый шаблон с таким именем

Так же можно использовать префиксы, например `lang` ([% lang:ключ_перевода %]), для того чтобы подставлять переводы из файла переводов, прописанного в config.json

### Поддерживаемые префиксы:

`lang` - ищет перевод по переданному в него имени

### Описание шаблона в html файле
В любом блоке можно создать файл `имя_блока.jn.html`. При сборке этот файл будет расцениваться, как файл содержащий шаблоны.
Каждый шаблон в этом файле начинается с имени шаблона, записанного как `<!--: имя_шаблона :-->`.
И заканчивается при нахождении имени следующего шаблона или конца файла.

### Описание шаблона в js файле
Помимо файла `имя_блока.jn.html` в любом блоке можно создать файл `имя_блока.jn.js`. При сборке этот файл будет помещен в анонимную функцию и как есть записан в собранный файл. Такие файлы следует использовать для создания текстовых шаблонов, которые не являются html сущностями и шаблонов функций.
```jn.create(name, tmpl)``` позволяет создать текстовый шаблон или шаблон функции.

### Уровни переопределения

`config.json`

* lang_file - json файл с переводами
* lang_default - ключ языка, который будет использован при отсутствии перевода на собираемый язык
* lang_list - список собираемых языков
* tmpl_levels - собираемые уровни переопределения шаблонов в порядке от старшего к младшему
* init_tmpl - шаблон, который в собранном виде будет записан в соответствующий index.{lang}.html

```json
{
    "lang_file": "lang.json",
    "lang_default": "ru",
    "lang_list": ["ru", "en"],
    "tmpl_levels": [
        ["common", "desktop"],
        ["common", "tablet"],
        ["common", "touch"]
    ],
    "init_tmpl": "document"
}
```

Структура проекта и сборка

//TODO: Описать

```
|-/ app
  |-/ common
    |-/ document
      |- document.jn.html
      |- document.jn.js
    |-/ body
      |- body.jn.html
      |- body.jn.js
      |- body.styl
    |-/ menu
      |- menu.jn.html
      |- menu.styl
  |-/ desktop
    |-/ document
      |- document.jn.js
    |-/ body
      |- body.jn.html
      |- body.styl
      |- body.js
    |-/ menu
    |-/ scroller
  |-/ touch
    |-/ document
      |- document.jn.html
    |-/ body
      |- body.jn.html
      |- body.styl
      |- body.js
    |-/ menu
    |-/ swiper
  |-/ tablet
    |-/ document
    |-/ body
    |-/ swiper
  |- build
    |-/ common-desktop
      |- all.css
      |- all.js
      |- index.en.html
      |- index.ru.html
    |-/ common-touch
      |- all.css
      |- all.js
      |- index.en.html
      |- index.ru.html
    |-/ common-tablet
      |- all.css
      |- all.js
      |- index.en.html
      |- index.ru.html
```


//TODO: починить сборку js - ^M
//TODO: неверно вызываются шаблоны, если из верхнего уровня вызывается нижний
//TODO: тесты